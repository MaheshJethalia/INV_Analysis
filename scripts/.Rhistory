geom_hline(yintercept=c(0,25,50), color=c("black","blue","red")) + geom_vline(xintercept = 0) +
theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + xlim(c(0.0,100))+
geom_text(aes(x=100*generatio,y=-log10(p.value),label=term_name),
data=temp_df,
hjust = 0, vjust = 0, nudge_x = 0.025, angle = 0,
size = 3, check_overlap = T) +
ggtitle("Enriched GO Terms for INV High Phenotype") + theme(text = element_text(size=14)) + theme(plot.title = element_text(hjust = 0.5))
supp_p6a
supp_p6a <- ggplot(final_inv_high_goterms_df,aes(x=100*generatio,y=-log10(p.value), shape=term_category)) + geom_point(aes(color=as.factor(term_level))) +
xlab("Percentage of MRs in each GO Term") + ylab("-log10(Pvalue)") + scale_shape_manual(name = "GO Terms", values = 1:nlevels(as.factor(inv_high_goterms_df$term_category))) +
scale_color_manual(name = "Term Level", values =  c("grey","violet","orange")) +
geom_hline(yintercept=c(1,35,50), color=c("black","blue","red")) + geom_vline(xintercept = 0) +
theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + xlim(c(0.0,100))+
geom_text(aes(x=100*generatio,y=-log10(p.value),label=term_name),
data=temp_df,
hjust = 0, vjust = 0, nudge_x = 0.025, angle = 0,
size = 3, check_overlap = T) +
ggtitle("Enriched GO Terms for INV High Phenotype") + theme(text = element_text(size=14)) + theme(plot.title = element_text(hjust = 0.5))
supp_p6a
supp_p6a <- ggplot(final_inv_high_goterms_df,aes(x=100*generatio,y=-log10(p.value), shape=term_category)) + geom_point(aes(color=as.factor(term_level))) +
xlab("Percentage of MRs in each GO Term") + ylab("-log10(Pvalue)") + scale_shape_manual(name = "GO Terms", values = 1:nlevels(as.factor(inv_high_goterms_df$term_category))) +
scale_color_manual(name = "Term Level", values =  c("grey","violet","orange")) +
geom_hline(yintercept=c(1,35,50), color=c("black","blue","red")) + geom_vline(xintercept = 0) +
theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + xlim(c(0.0,100))+
geom_text(aes(x=100*generatio,y=-log10(p.value),label=term_name),
data=temp_df,
hjust = 0, vjust = 0, nudge_x = 0.025, angle = 0,
size = 3, check_overlap = T) +
ggtitle("Enriched GO Terms for INV High Phenotype") + theme(text = element_text(size=11)) + theme(plot.title = element_text(hjust = 0.5))
supp_p6a
supp_p6a <- ggplot(final_inv_high_goterms_df,aes(x=100*generatio,y=-log10(p.value), shape=term_category)) + geom_point(aes(color=as.factor(term_level))) +
xlab("Percentage of MRs in each GO Term") + ylab("-log10(Pvalue)") + scale_shape_manual(name = "GO Terms", values = 1:nlevels(as.factor(inv_high_goterms_df$term_category))) +
scale_color_manual(name = "Term Level", values =  c("grey","violet","orange")) +
geom_hline(yintercept=c(1,35,50), color=c("black","blue","red")) + geom_vline(xintercept = 0) +
theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + xlim(c(0.0,100))+
geom_text(aes(x=100*generatio,y=-log10(p.value),label=term_name),
data=temp_df,
hjust = 0, vjust = 0, nudge_x = 0.025, angle = 0,
size = 3, check_overlap = T) +
ggtitle("Enriched GO Terms for INV High Phenotype") + theme(text = element_text(size=14)) + theme(plot.title = element_text(hjust = 0.5))
ggsave(file="../Results/Paper_Figures/Svgs_Jpgs/Supp_Figure_6A.jpg",plot = supp_p6a, device = jpeg(), width = 10, height=10, units = "in", dpi = 300)
dev.off()
ls
inv_low_goterms_df <- read.table("../Results/Paper_Text/Enriched_GOTerms_INV_Low.csv",header=TRUE,sep="\t")
inv_low_goterms_df$generatio <- unlist(lapply(strsplit(as.character(inv_low_goterms_df$members_input_overlap_geneids),split="; "), length))/inv_low_goterms_df$size
inv_high_goterms_df <- read.table("../Results/Paper_Text/Enriched_GOTerms_INV_High.csv",header=TRUE,sep="\t")
inv_high_goterms_df$generatio <- unlist(lapply(strsplit(as.character(inv_high_goterms_df$members_input_overlap_geneids),split="; "), length))/inv_high_goterms_df$size
inv_high_case_vs_control <- data.frame(gene=inv_high_specific_mrs,fc=rep(1,length(inv_high_specific_mrs)))
final_inv_high_goterms_df <- clean_go_terms(df_case_vs_ctrl = inv_high_case_vs_control, df_goterms = inv_high_goterms_df)
inv_low_goterms_df <- read.table("../Results/Paper_Text/Enriched_GOTerms_INV_Low.csv",header=TRUE,sep="\t")
inv_low_goterms_df$generatio <- unlist(lapply(strsplit(as.character(inv_low_goterms_df$members_input_overlap_geneids),split="; "), length))/inv_low_goterms_df$size
inv_low_case_vs_control <- data.frame(gene=inv_low_specific_mrs,fc=rep(-1,length(inv_low_specific_mrs)))
final_inv_low_goterms_df <- clean_go_terms(df_case_vs_ctrl = inv_low_case_vs_control, df_goterms = inv_low_goterms_df)
temp_df <- inv_low_goterms_df[-log10(inv_low_goterms_df$p.value)>30,]
temp_df <- inv_low_goterms_df[-log10(inv_low_goterms_df$p.value)>25,]
temp_df <- inv_low_goterms_df[-log10(inv_low_goterms_df$p.value)>20,]
supp_p6b <- ggplot(inv_low_goterms_df,aes(x=100*generatio,y=-log10(p.value), shape=term_category)) +
geom_point(aes(color=as.factor(term_level))) +
xlab("Percentage of MRs in each GO Term") + ylab("-log10(Pvalue)") +
scale_shape_manual(name = "GO Terms", values = 1:nlevels(as.factor(inv_low_goterms_df$term_category))) +
scale_color_manual(name = "Term Level", values =  c("grey","violet","orange")) +
geom_hline(yintercept=c(0,20,30), color=c("black","blue","red")) + geom_vline(xintercept = 0) +
theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
geom_text(aes(x=100*generatio,y=-log10(p.value),label=term_name),
data=temp_df,
hjust = 0, vjust = 0, nudge_x = 0.025, angle = 0,
size = 3, check_overlap = T) +
coord_cartesian(xlim =c(0, 80), ylim = c(0, 70)) +
ggtitle("Enriched GO Terms for INV Low Phenotype") + theme(text = element_text(size=14)) + theme(plot.title = element_text(hjust = 0.5))
supp_p6b
supp_p6b <- ggplot(inv_low_goterms_df,aes(x=100*generatio,y=-log10(p.value), shape=term_category)) +
geom_point(aes(color=as.factor(term_level))) +
xlab("Percentage of MRs in each GO Term") + ylab("-log10(Pvalue)") +
scale_shape_manual(name = "GO Terms", values = 1:nlevels(as.factor(inv_low_goterms_df$term_category))) +
scale_color_manual(name = "Term Level", values =  c("grey","violet","orange")) +
geom_hline(yintercept=c(0,20,30), color=c("black","blue","red")) + geom_vline(xintercept = 0) +
theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
geom_text(aes(x=100*generatio,y=-log10(p.value),label=term_name),
data=temp_df,
hjust = 0, vjust = 0, nudge_x = 0.025, angle = 0,
size = 3, check_overlap = T) +
coord_cartesian(xlim =c(0, 80), ylim = c(0, 30)) +
ggtitle("Enriched GO Terms for INV Low Phenotype") + theme(text = element_text(size=14)) + theme(plot.title = element_text(hjust = 0.5))
supp_p6b
ggsave(file="../Results/Paper_Figures/Svgs_Jpgs/Supp_Figure_6B.jpg",plot = supp_p6b, device = jpeg(), width = 10, height=10, units = "in", dpi = 300)
dev.off()
#Make Figure 4B
#===========================================================================================================
colors <- c('#3cb44b', '#4363d8', '#f58231', '#911eb4', '#f032e6', '#46f0f0' , '#bcf60c', '#a9a9a9', '#e6194b', '#ffe119', '#ffe119', '#e6beff')
inv_low_pathways_df <- read.table("../Results/Paper_Text/Enriched_Pathways_INV_Low.csv", header=T, sep="\t")
final_inv_low_pathways_df <- clean_pathways(df_case_vs_ctrl = inv_low_case_vs_control, df_pathway = inv_low_pathways_df)
final_inv_low_pathways_df
write.table(final_inv_low_pathways_df,"../Results/Paper_Text/Supplementary_Table_S5_INV_Low_Pathwyas.csv",row.names=F, col.names=T, quote=F, sep="\t")
final_inv_low_pathways_df$Description <- as.character(as.vector(final_inv_low_pathways_df$Description))
final_inv_low_pathways_df$GeneRatio <- as.character(as.vector(final_inv_low_pathways_df$GeneRatio))
final_inv_low_pathways_df$genes <- as.character(as.vector(final_inv_low_pathways_df$genes))
final_inv_low_pathways_df$Description <- paste0(final_inv_low_pathways_df$Description," [",final_inv_low_pathways_df$GeneRatio,"] ")
final_inv_low_pathways_df <- final_inv_low_pathways_df[order(final_inv_low_pathways_df$generatio),]
p5 <- ggplot(data=final_inv_low_pathways_df,aes(x=generatio,y=reorder(Description,generatio),size=-log10(pvalue)))+
geom_point(aes(color=-log10(pvalue)))+xlab("Gene Ratio") + ylab("Enriched Pathways") +  scale_color_continuous(name="-log10(P.adjust)", low="blue", high="red", guide=guide_colorbar(reverse=TRUE))+
scale_size_continuous(name = "-log10(P.adjust)")+   guides(color=guide_legend(), size = guide_legend())+
theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
ggtitle("Enriched Pathways for INV Low Phenotype") +
theme(text = element_text(size=14,color="black")) + theme(axis.text = element_text(size=14, color="black")) +
theme(plot.title = element_text(hjust = 0.5,color="black")) +
theme(axis.text.y=element_text(color=colors[(final_inv_low_pathways_df$clusters)]))
colors <- c('#3cb44b', '#4363d8', '#f58231', '#911eb4', '#f032e6', '#46f0f0' , '#bcf60c', '#a9a9a9', '#e6194b', '#ffe119', '#ffe119', '#e6beff')
inv_low_pathways_df <- read.table("../Results/Paper_Text/Enriched_Pathways_INV_Low.csv", header=T, sep="\t")
final_inv_low_pathways_df <- clean_pathways(df_case_vs_ctrl = inv_low_case_vs_control, df_pathway = inv_low_pathways_df)
write.table(final_inv_low_pathways_df,"../Results/Paper_Text/Supplementary_Table_S5_INV_Low_Pathwyas.csv",row.names=F, col.names=T, quote=F, sep="\t")
final_inv_low_pathways_df$Description <- as.character(as.vector(final_inv_low_pathways_df$Description))
colnameS(final_inv_low_pathways_df)
colnames(final_inv_low_pathways_df)
final_inv_low_goterms_df
final_inv_low_goterms_df
final_inv_low_pathways_df
colnames(final_inv_enabled_median_comparison)
colnames(final_inv_low_pathways_df)
final_inv_low_goterms_df$size
final_inv_low_goterms_df$effective_size
final_inv_low_pathways_df$size
final_inv_low_pathways_df$effective_size
final_inv_low_pathways_df$genes_down/final_inv_low_pathways_df$effective_size
final_inv_low_pathways_df$pathway
inv_low_pathways_df
final_inv_low_pathways_df$pathway <- as.character(as.vector(final_inv_low_pathways_df$pathway))
final_inv_low_pathways_df$generatio <- final_inv_low_pathways_df$genes_down/final_inv_low_pathways_df$effective_size
final_inv_low_pathways_df <- final_inv_low_pathways_df[order(final_inv_low_pathways_df$generatio),]
colnames(final_inv_low_pathways_df)
final_inv_low_pathways_df$pathway <- as.character(as.vector(final_inv_low_pathways_df$pathway))
final_inv_low_pathways_df$generatio <- final_inv_low_pathways_df$genes_down/final_inv_low_pathways_df$effective_size
final_inv_low_pathways_df <- final_inv_low_pathways_df[order(final_inv_low_pathways_df$generatio),]
p5 <- ggplot(data=final_inv_low_pathways_df,aes(x=generatio,y=reorder(pathway,generatio),size=-log10(q.value)))+
geom_point(aes(color=-log10(q.value)))+xlab("Gene Ratio") + ylab("Enriched Pathways") +
scale_color_continuous(name="-log10(P.adjust)", low="blue", high="red", guide=guide_colorbar(reverse=TRUE))+
scale_size_continuous(name = "-log10(P.adjust)")+   guides(color=guide_legend(), size = guide_legend())+
theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
ggtitle("Enriched Pathways for INV Low Phenotype") +
theme(text = element_text(size=14,color="black")) + theme(axis.text = element_text(size=14, color="black")) +
theme(plot.title = element_text(hjust = 0.5,color="black")) +
theme(axis.text.y=element_text(color=colors[(final_inv_low_pathways_df$clusters)]))
p5
final_inv_low_pathways_df$pathway <- as.character(as.vector(final_inv_low_pathways_df$pathway))
final_inv_low_pathways_df$Generatio <- paste0(final_inv_low_pathways_df$genes_down,"/",final_inv_low_pathways_df$effective_size)
final_inv_low_pathways_df$generatio <- final_inv_low_pathways_df$genes_down/final_inv_low_pathways_df$effective_size
colors <- c('#3cb44b', '#4363d8', '#f58231', '#911eb4', '#f032e6', '#46f0f0' , '#bcf60c', '#a9a9a9', '#e6194b', '#ffe119', '#ffe119', '#e6beff')
inv_low_pathways_df <- read.table("../Results/Paper_Text/Enriched_Pathways_INV_Low.csv", header=T, sep="\t")
final_inv_low_pathways_df <- clean_pathways(df_case_vs_ctrl = inv_low_case_vs_control, df_pathway = inv_low_pathways_df)
write.table(final_inv_low_pathways_df,"../Results/Paper_Text/Supplementary_Table_S5_INV_Low_Pathwyas.csv",row.names=F, col.names=T, quote=F, sep="\t")
final_inv_low_pathways_df$pathway <- as.character(as.vector(final_inv_low_pathways_df$pathway))
final_inv_low_pathways_df$Generatio <- paste0(final_inv_low_pathways_df$genes_down,"/",final_inv_low_pathways_df$effective_size)
final_inv_low_pathways_df$generatio <- final_inv_low_pathways_df$genes_down/final_inv_low_pathways_df$effective_size
final_inv_low_pathways_df$Description <- paste0(final_inv_low_pathways_df$pathway,'[',final_inv_low_pathways_df$Generatio,']')
p5 <- ggplot(data=final_inv_low_pathways_df,aes(x=generatio,y=reorder(Description,generatio),size=-log10(q.value)))+
geom_point(aes(color=-log10(q.value)))+xlab("Gene Ratio") + ylab("Enriched Pathways") +
scale_color_continuous(name="-log10(P.adjust)", low="blue", high="red", guide=guide_colorbar(reverse=TRUE))+
scale_size_continuous(name = "-log10(P.adjust)")+   guides(color=guide_legend(), size = guide_legend())+
theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
ggtitle("Enriched Pathways for INV Low Phenotype") +
theme(text = element_text(size=14,color="black")) + theme(axis.text = element_text(size=14, color="black")) +
theme(plot.title = element_text(hjust = 0.5,color="black")) +
theme(axis.text.y=element_text(color=colors[(final_inv_low_pathways_df$clusters)]))
p5
colors <- c('#3cb44b', '#4363d8', '#f58231', '#911eb4', '#f032e6', '#46f0f0' , '#bcf60c', '#a9a9a9', '#e6194b', '#ffe119', '#ffe119', '#e6beff')
inv_low_pathways_df <- read.table("../Results/Paper_Text/Enriched_Pathways_INV_Low.csv", header=T, sep="\t")
final_inv_low_pathways_df <- clean_pathways(df_case_vs_ctrl = inv_low_case_vs_control, df_pathway = inv_low_pathways_df)
write.table(final_inv_low_pathways_df,"../Results/Paper_Text/Supplementary_Table_S5_INV_Low_Pathwyas.csv",row.names=F, col.names=T, quote=F, sep="\t")
final_inv_low_pathways_df$pathway <- as.character(as.vector(final_inv_low_pathways_df$pathway))
final_inv_low_pathways_df$Generatio <- paste0(final_inv_low_pathways_df$genes_down,"/",final_inv_low_pathways_df$effective_size)
final_inv_low_pathways_df$generatio <- final_inv_low_pathways_df$genes_down/final_inv_low_pathways_df$effective_size
final_inv_low_pathways_df$Description <- paste0(final_inv_low_pathways_df$pathway,' [',final_inv_low_pathways_df$Generatio,']')
final_inv_low_pathways_df <- final_inv_low_pathways_df[order(final_inv_low_pathways_df$generatio),]
p5 <- ggplot(data=final_inv_low_pathways_df,aes(x=generatio,y=reorder(Description,generatio),size=-log10(q.value)))+
geom_point(aes(color=-log10(q.value)))+xlab("Gene Ratio") + ylab("Enriched Pathways") +
scale_color_continuous(name="-log10(P.adjust)", low="blue", high="red", guide=guide_colorbar(reverse=TRUE))+
scale_size_continuous(name = "-log10(P.adjust)")+   guides(color=guide_legend(), size = guide_legend())+
theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
ggtitle("Enriched Pathways for INV Low Phenotype") +
theme(text = element_text(size=14,color="black")) + theme(axis.text = element_text(size=14, color="black")) +
theme(plot.title = element_text(hjust = 0.5,color="black")) +
theme(axis.text.y=element_text(color=colors[(final_inv_low_pathways_df$clusters)]))
p5
ggsave(filename = "../Results/Paper_Figures/Figure4/Enriched_Pathways_INV_Low_Figure_4B.pdf",plot=p5,device=pdf(), height=10, width=10, units="in", dpi=300)
dev.off()
pdf("../Results/Paper_Figures/Figure4/Common_TopMRs_Activity_INV_Figure_4A.pdf",height = 12, width=14, pointsize = 11)
par(bg="white")
par(fg="black",col.axis="black",col.main="black",col.lab="black", cex.main=1.5)
p1 <- heatmap.3(final_common_mrs_enabled_activity_matrix, Rowv = TRUE, Colv=F, col = bluered(100), scale="none", main= "Median Activity of Common MRs in INV Enabled Cancers", # (>=4 out of 8)",
dendrogram = "both", key = TRUE, density.info = "none", KeyValueName = "Activity Value", ColSideColors = colcol, ColSideColorsSize = 2,
margins = c(6,6), useRaster = FALSE, cexRow = 1.0, cexCol = 1.5, cellnote = ifelse(final_common_mrs_enabled_activity_matrix>0,"+","-"), notecex = 1, notecol = "black")
dev.off()
colors <- c('#3cb44b', '#4363d8', '#f58231', '#911eb4', '#f032e6', '#46f0f0' , '#bcf60c', '#a9a9a9', '#e6194b', '#ffe119', '#ffe119', '#e6beff')
inv_low_pathways_df <- read.table("../Results/Paper_Text/Enriched_Pathways_INV_Low.csv", header=T, sep="\t")
final_inv_low_pathways_df <- clean_pathways(df_case_vs_ctrl = inv_low_case_vs_control, df_pathway = inv_low_pathways_df)
write.table(final_inv_low_pathways_df,"../Results/Paper_Text/Supplementary_Table_S5_INV_Low_Pathwyas.csv",row.names=F, col.names=T, quote=F, sep="\t")
final_inv_low_pathways_df$pathway <- as.character(as.vector(final_inv_low_pathways_df$pathway))
final_inv_low_pathways_df$Generatio <- paste0(final_inv_low_pathways_df$genes_down,"/",final_inv_low_pathways_df$effective_size)
final_inv_low_pathways_df$generatio <- final_inv_low_pathways_df$genes_down/final_inv_low_pathways_df$effective_size
final_inv_low_pathways_df$Description <- paste0(final_inv_low_pathways_df$pathway,' [',final_inv_low_pathways_df$Generatio,']')
final_inv_low_pathways_df <- final_inv_low_pathways_df[order(final_inv_low_pathways_df$generatio),]
p5 <- ggplot(data=final_inv_low_pathways_df,aes(x=generatio,y=reorder(Description,generatio),size=-log10(q.value)))+
geom_point(aes(color=-log10(q.value)))+xlab("Gene Ratio") + ylab("Enriched Pathways") +
scale_color_continuous(name="-log10(P.adjust)", low="blue", high="red", guide=guide_colorbar(reverse=TRUE))+
scale_size_continuous(name = "-log10(P.adjust)")+   guides(color=guide_legend(), size = guide_legend())+
theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
ggtitle("Enriched Pathways for INV Low Phenotype") +
theme(text = element_text(size=14,color="black")) + theme(axis.text = element_text(size=14, color="black")) +
theme(plot.title = element_text(hjust = 0.5,color="black")) +
theme(axis.text.y=element_text(color=colors[(final_inv_low_pathways_df$clusters)]))
ggsave(filename = "../Results/Paper_Figures/Figure4/Enriched_Pathways_INV_Low_Figure_4B.pdf",plot=p5,device=pdf(), height=10, width=10, units="in", dpi=300)
dev.off()
final_inv_high_pathways_df <- read.table("../Results/Paper_Text/Final_Enriched_Pathways_INV_High.csv",header=TRUE,sep="\t")
final_inv_high_pathways_df <- read.table("../Results/Paper_Text/Enriched_Pathways_INV_High.csv",header=TRUE,sep="\t")
inv_high_pathways_df <- read.table("../Results/Paper_Text/Enriched_Pathways_INV_High.csv",header=TRUE,sep="\t")
final_inv_high_pathways_df <- clean_pathways(df_case_vs_ctrl = inv_high_case_vs_control, df_pathway = inv_high_pathways_df)
final_inv_high_goterms_df
final_inv_high_pathways_df$pathway
inv_high_pathways_df
inv_high_pathways_df <- read.table("../Results/Paper_Text/Enriched_Pathways_INV_High.csv",header=TRUE,sep="\t")
final_inv_high_pathways_df <- clean_pathways(df_case_vs_ctrl = inv_high_case_vs_control, df_pathway = inv_high_pathways_df)
inv_high_case_vs_control <- data.frame(gene=inv_high_specific_mrs,fc=rep(2,length(inv_high_specific_mrs)))
final_inv_high_pathways_df <- clean_pathways(df_case_vs_ctrl = inv_high_case_vs_control, df_pathway = inv_high_pathways_df)
final_inv_high_pathways_df
dim(final_inv_high_pathways_df)
write.table(final_inv_low_pathways_df,"../Results/Paper_Text/Supplementary_Table_S5_Final_Enriched_INV_Low_Pathways.csv",row.names=F, col.names=T, quote=F, sep="\t")
write.table(final_inv_high_pathways_df,"../Results/Paper_Text/Supplementary_Table_S6_Final_Enriched_Pathways_INV_High.csv",row.names=F, col.names=T, quote=F,sep="\t")
colors <- c('#3cb44b', '#4363d8', '#f58231', '#911eb4', '#f032e6', '#46f0f0' , '#bcf60c', '#a9a9a9', '#e6194b', '#ffe119', '#ffe119', '#e6beff')
inv_low_pathways_df <- read.table("../Results/Paper_Text/Enriched_Pathways_INV_Low.csv", header=T, sep="\t")
final_inv_low_pathways_df <- clean_pathways(df_case_vs_ctrl = inv_low_case_vs_control, df_pathway = inv_low_pathways_df)
write.table(final_inv_low_pathways_df,"../Results/Paper_Text/Supplementary_Table_S5_Final_Enriched_INV_Low_Pathways.csv",row.names=F, col.names=T, quote=F, sep="\t")
inv_high_pathways_df <- read.table("../Results/Paper_Text/Enriched_Pathways_INV_High.csv",header=TRUE,sep="\t")
final_inv_high_pathways_df <- clean_pathways(df_case_vs_ctrl = inv_high_case_vs_control, df_pathway = inv_high_pathways_df)
write.table(final_inv_high_pathways_df,"../Results/Paper_Text/Supplementary_Table_S6_Final_Enriched_Pathways_INV_High.csv",row.names=F, col.names=T, quote=F,sep="\t")
final_inv_high_pathways_df$pathway <- as.character(as.vector(final_inv_high_pathways_df$pathway))
final_inv_high_pathways_df$Generatio <- paste0(final_inv_high_pathways_df$genes_up,"/",final_inv_high_pathways_df$effective_size)
final_inv_high_pathways_df$generatio <- final_inv_high_pathways_df$genes_down/final_inv_high_pathways_df$effective_size
final_inv_high_pathways_df$Description <- paste0(final_inv_high_pathways_df$pathway,' [',final_inv_high_pathways_df$Generatio,']')
final_inv_high_pathways_df <- final_inv_high_pathways_df[order(final_inv_high_pathways_df$generatio),]
p6 <- ggplot(data=final_inv_high_pathways_df,aes(x=generatio,y=reorder(Description,generatio),size=-log10(pvalue)))+
geom_point(aes(color=-log10(pvalue)))+xlab("Gene Ratio") + ylab("Enriched Pathways") +  scale_color_continuous(name="-log10(P.adjust)", low="blue", high="red", guide=guide_colorbar(reverse=TRUE))+
scale_size_continuous(name = "-log10(P.adjust)")+ guides(color=guide_legend(), size = guide_legend())+
theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
ggtitle("Enriched Pathways for INV High Phenotype") + theme(text = element_text(size=10)) + theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.text.y=element_text(color=colors[as.factor(final_inv_high_pathways_df$clusters)]))
p6
final_inv_high_pathways_df <- final_inv_high_pathways_df[order(final_inv_high_pathways_df$generatio),]
p6 <- ggplot(data=final_inv_high_pathways_df,aes(x=generatio,y=reorder(Description,generatio),size=-log10(q.value)))+
geom_point(aes(color=-log10(q.value)))+xlab("Gene Ratio") + ylab("Enriched Pathways") +  scale_color_continuous(name="-log10(P.adjust)", low="blue", high="red", guide=guide_colorbar(reverse=TRUE))+
scale_size_continuous(name = "-log10(P.adjust)")+ guides(color=guide_legend(), size = guide_legend())+
theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
ggtitle("Enriched Pathways for INV High Phenotype") + theme(text = element_text(size=10)) + theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.text.y=element_text(color=colors[as.factor(final_inv_high_pathways_df$clusters)]))
p6
inv_high_pathways_df <- read.table("../Results/Paper_Text/Enriched_Pathways_INV_High.csv",header=TRUE,sep="\t")
final_inv_high_pathways_df <- clean_pathways(df_case_vs_ctrl = inv_high_case_vs_control, df_pathway = inv_high_pathways_df)
write.table(final_inv_high_pathways_df,"../Results/Paper_Text/Supplementary_Table_S6_Final_Enriched_Pathways_INV_High.csv",row.names=F, col.names=T, quote=F,sep="\t")
final_inv_high_pathways_df$pathway <- as.character(as.vector(final_inv_high_pathways_df$pathway))
final_inv_high_pathways_df$Generatio <- paste0(final_inv_high_pathways_df$genes_up,"/",final_inv_high_pathways_df$effective_size)
final_inv_high_pathways_df$generatio <- final_inv_high_pathways_df$genes_down/final_inv_high_pathways_df$effective_size
final_inv_high_pathways_df$Description <- paste0(final_inv_high_pathways_df$pathway,' [',final_inv_high_pathways_df$Generatio,']')
final_inv_high_pathways_df$generatio <- final_inv_high_pathways_df[order(final_inv_high_pathways_df$generatio),]
p6 <- ggplot(data=final_inv_high_pathways_df,aes(x=generatio,y=reorder(Description,generatio),size=-log10(q.value)))+
geom_point(aes(color=-log10(q.value)))+xlab("Gene Ratio") + ylab("Enriched Pathways") +  scale_color_continuous(name="-log10(P.adjust)", low="blue", high="red", guide=guide_colorbar(reverse=TRUE))+
scale_size_continuous(name = "-log10(P.adjust)")+ guides(color=guide_legend(), size = guide_legend())+
theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
ggtitle("Enriched Pathways for INV High Phenotype") + theme(text = element_text(size=10)) + theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.text.y=element_text(color=colors[as.factor(final_inv_high_pathways_df$clusters)]))
p6
inv_high_pathways_df <- read.table("../Results/Paper_Text/Enriched_Pathways_INV_High.csv",header=TRUE,sep="\t")
final_inv_high_pathways_df <- clean_pathways(df_case_vs_ctrl = inv_high_case_vs_control, df_pathway = inv_high_pathways_df)
write.table(final_inv_high_pathways_df,"../Results/Paper_Text/Supplementary_Table_S6_Final_Enriched_Pathways_INV_High.csv",row.names=F, col.names=T, quote=F,sep="\t")
final_inv_high_pathways_df$pathway <- as.character(as.vector(final_inv_high_pathways_df$pathway))
final_inv_high_pathways_df$Generatio <- paste0(final_inv_high_pathways_df$genes_up,"/",final_inv_high_pathways_df$effective_size)
final_inv_high_pathways_df$generatio <- final_inv_high_pathways_df$genes_down/final_inv_high_pathways_df$effective_size
final_inv_high_pathways_df$Description <- paste0(final_inv_high_pathways_df$pathway,' [',final_inv_high_pathways_df$Generatio,']')
final_inv_high_pathways_df <- final_inv_high_pathways_df[order(final_inv_high_pathways_df$generatio),]
final_inv_enabled_median_comparison
final_inv_high_pathways_df
p6 <- ggplot(data=final_inv_high_pathways_df,aes(x=generatio,y=reorder(Description,generatio),size=-log10(q.value)))+
geom_point(aes(color=-log10(q.value)))+xlab("Gene Ratio") + ylab("Enriched Pathways") +  scale_color_continuous(name="-log10(P.adjust)", low="blue", high="red", guide=guide_colorbar(reverse=TRUE))+
scale_size_continuous(name = "-log10(P.adjust)")+ guides(color=guide_legend(), size = guide_legend())+
theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
ggtitle("Enriched Pathways for INV High Phenotype") + theme(text = element_text(size=10)) + theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.text.y=element_text(color=colors[as.factor(final_inv_high_pathways_df$clusters)]))
p6
inv_high_pathways_df <- read.table("../Results/Paper_Text/Enriched_Pathways_INV_High.csv",header=TRUE,sep="\t")
final_inv_high_pathways_df <- clean_pathways(df_case_vs_ctrl = inv_high_case_vs_control, df_pathway = inv_high_pathways_df)
write.table(final_inv_high_pathways_df,"../Results/Paper_Text/Supplementary_Table_S6_Final_Enriched_Pathways_INV_High.csv",row.names=F, col.names=T, quote=F,sep="\t")
final_inv_high_pathways_df$pathway <- as.character(as.vector(final_inv_high_pathways_df$pathway))
final_inv_high_pathways_df$Generatio <- paste0(final_inv_high_pathways_df$genes_up,"/",final_inv_high_pathways_df$effective_size)
final_inv_high_pathways_df$generatio <- final_inv_high_pathways_df$genes_up/final_inv_high_pathways_df$effective_size
final_inv_high_pathways_df$Description <- paste0(final_inv_high_pathways_df$pathway,' [',final_inv_high_pathways_df$Generatio,']')
final_inv_high_pathways_df <- final_inv_high_pathways_df[order(final_inv_high_pathways_df$generatio),]
p6 <- ggplot(data=final_inv_high_pathways_df,aes(x=generatio,y=reorder(Description,generatio),size=-log10(q.value)))+
geom_point(aes(color=-log10(q.value)))+xlab("Gene Ratio") + ylab("Enriched Pathways") +  scale_color_continuous(name="-log10(P.adjust)", low="blue", high="red", guide=guide_colorbar(reverse=TRUE))+
scale_size_continuous(name = "-log10(P.adjust)")+ guides(color=guide_legend(), size = guide_legend())+
theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
ggtitle("Enriched Pathways for INV High Phenotype") + theme(text = element_text(size=10)) + theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.text.y=element_text(color=colors[as.factor(final_inv_high_pathways_df$clusters)]))
fip6
p6
inv_high_pathways_df <- read.table("../Results/Paper_Text/Enriched_Pathways_INV_High.csv",header=TRUE,sep="\t")
final_inv_high_pathways_df <- clean_pathways(df_case_vs_ctrl = inv_high_case_vs_control, df_pathway = inv_high_pathways_df)
write.table(final_inv_high_pathways_df,"../Results/Paper_Text/Supplementary_Table_S6_Final_Enriched_Pathways_INV_High.csv",row.names=F, col.names=T, quote=F,sep="\t")
final_inv_high_pathways_df$pathway <- as.character(as.vector(final_inv_high_pathways_df$pathway))
final_inv_high_pathways_df$Generatio <- paste0(final_inv_high_pathways_df$genes_up,"/",final_inv_high_pathways_df$effective_size)
final_inv_high_pathways_df$generatio <- final_inv_high_pathways_df$genes_up/final_inv_high_pathways_df$effective_size
final_inv_high_pathways_df$Description <- paste0(final_inv_high_pathways_df$pathway,' [',final_inv_high_pathways_df$Generatio,']')
final_inv_high_pathways_df <- final_inv_high_pathways_df[order(final_inv_high_pathways_df$generatio),]
p6 <- ggplot(data=final_inv_high_pathways_df,aes(x=generatio,y=reorder(Description,generatio),size=-log10(q.value)))+
geom_point(aes(color=-log10(q.value)))+xlab("Gene Ratio") + ylab("Enriched Pathways") +  scale_color_continuous(name="-log10(P.adjust)", low="blue", high="red", guide=guide_colorbar(reverse=TRUE))+
scale_size_continuous(name = "-log10(P.adjust)")+ guides(color=guide_legend(), size = guide_legend())+
theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
ggtitle("Enriched Pathways for INV High Phenotype") + theme(text = element_text(size=14)) + theme(plot.title = element_text(hjust = 0.5)) +
theme(axis.text.y=element_text(color=colors[as.factor(final_inv_high_pathways_df$clusters)]))
p6
ggsave(filename = "../Results/Paper_Figures/Figure4/Enriched_Pathways_INV_High_Figure_4D.pdf",plot=p6,device=jpeg(), height=12, width=15, units="in", dpi=300)
dev.off()
ggsave(filename = "../Results/Paper_Figures/Figure4/Enriched_Pathways_INV_High_Figure_4D.pdf",plot=p6,device=jpeg(), height=12, width=12, units="in", dpi=300)
dev.off()
final_inv_high_pathways_df$clusters
table(final_inv_high_pathways_df$clusters)
library(circlize)
col_fun = colorRamp2(c(-0.1, 0, 0.1), c("blue", "white", "red"))
col_fun(seq(-3, 3))
final_inv_high_pathways_df <- final_inv_high_pathways_df[order(final_inv_high_pathways_df$generatio,decreasing = T),]
inv_high_pathways_gene_involved <- matrix(0,nrow=nrow(final_inv_high_pathways_df),ncol=length(rownames(positive_mrs_inv_high_activity_matrix)))
library(circlize)
col_fun = colorRamp2(c(-0.1, 0, 0.1), c("blue", "white", "red"))
col_fun(seq(-3, 3))
#Figure 4C
#================================================================================================================
rev_inv_high_pathways_df <- final_inv_high_pathways_df[order(final_inv_high_pathways_df$generatio,decreasing = T),]
rev_inv_high_pathways_df <- final_inv_high_pathways_df[order(final_inv_high_pathways_df$generatio,decreasing = T),]
library(circlize)
col_fun = colorRamp2(c(-0.1, 0, 0.1), c("blue", "white", "red"))
col_fun(seq(-3, 3))
#Figure 4C
#================================================================================================================
rev_inv_high_pathways_df <- final_inv_high_pathways_df[order(final_inv_high_pathways_df$generatio,decreasing = T),]
positive_mrs_inv_high_activity_matrix <- common_mrs_enabled_activity_matrix[inv_high_specific_mrs,]
dim(positive_mrs_inv_high_activity_matrix)
positive_mrs_inv_high_activity_matrix <- common_mrs_enabled_activity_matrix[inv_high_specific_mrs,]
rev_inv_high_pathways_df <- final_inv_high_pathways_df[order(final_inv_high_pathways_df$generatio,decreasing = T),]
inv_high_pathways_gene_involved <- matrix(0,nrow=nrow(rev_inv_high_pathways_df),ncol=length(rownames(positive_mrs_inv_low_activity_matrix)))
inv_high_pathways_gene_involved <- matrix(0,nrow=nrow(rev_inv_high_pathways_df),ncol=length(rownames(positive_mrs_inv_high_activity_matrix)))
rownames(inv_high_pathways_gene_involved) <- rev_inv_high_pathways_df$Description
inv_high_pathways_gene_involved
colnames(inv_low_pathways_gene_involved) <- rownames(positive_mrs_inv_low_activity_matrix)
colnames(inv_low_pathways_gene_involved) <- rownames(positive_mrs_inv_high_activity_matrix)
library(circlize)
col_fun = colorRamp2(c(-0.1, 0, 0.1), c("blue", "white", "red"))
col_fun(seq(-3, 3))
#Figure 4C
#================================================================================================================
positive_mrs_inv_high_activity_matrix <- common_mrs_enabled_activity_matrix[inv_high_specific_mrs,]
rev_inv_high_pathways_df <- final_inv_high_pathways_df[order(final_inv_high_pathways_df$generatio,decreasing = T),]
inv_high_pathways_gene_involved <- matrix(0,nrow=nrow(rev_inv_high_pathways_df),ncol=length(rownames(positive_mrs_inv_high_activity_matrix)))
rownames(inv_high_pathways_gene_involved) <- rev_inv_high_pathways_df$Description
colnames(inv_high_pathways_gene_involved) <- rownames(positive_mrs_inv_high_activity_matrix)
positive_mrs_inv_high_activity_matrix <- common_mrs_enabled_activity_matrix[inv_high_specific_mrs,]
rev_inv_high_pathways_df <- final_inv_high_pathways_df[order(final_inv_high_pathways_df$generatio,decreasing = T),]
inv_high_pathways_gene_involved <- matrix(0,nrow=nrow(rev_inv_high_pathways_df),ncol=length(rownames(positive_mrs_inv_high_activity_matrix)))
rownames(inv_high_pathways_gene_involved) <- rev_inv_high_pathways_df$Description
colnames(inv_high_pathways_gene_involved) <- rownames(positive_mrs_inv_high_activity_matrix)
for (i in 1:nrow(rev_inv_high_pathways_df))
{
genes_involved <- unlist(strsplit(rev_inv_high_pathways_df[i,]$genes,split="; "))
median_activity_scores <- rowMedians(positive_mrs_inv_high_activity_matrix[genes_involved,])
inv_high_pathways_gene_involved[i,genes_involved] <- median_activity_scores
}
rev_inv_high_pathways_df$members_input_overlap_geneids
rev_inv_high_pathways_df$members_input_overlap
positive_mrs_inv_high_activity_matrix <- common_mrs_enabled_activity_matrix[inv_high_specific_mrs,]
rev_inv_high_pathways_df <- final_inv_high_pathways_df[order(final_inv_high_pathways_df$generatio,decreasing = T),]
inv_high_pathways_gene_involved <- matrix(0,nrow=nrow(rev_inv_high_pathways_df),ncol=length(rownames(positive_mrs_inv_high_activity_matrix)))
rownames(inv_high_pathways_gene_involved) <- rev_inv_high_pathways_df$Description
colnames(inv_high_pathways_gene_involved) <- rownames(positive_mrs_inv_high_activity_matrix)
for (i in 1:nrow(rev_inv_high_pathways_df))
{
genes_involved <- unlist(strsplit(rev_inv_high_pathways_df[i,]$members_input_overlap,split="; "))
median_activity_scores <- rowMedians(positive_mrs_inv_high_activity_matrix[genes_involved,])
inv_high_pathways_gene_involved[i,genes_involved] <- median_activity_scores
}
inv_high_pathways_gene_involved
inv_high_pathways_gene_involved_to_consider <- inv_high_pathways_gene_involved[,which(colSums(inv_high_pathways_gene_involved)>0)]
inv_high_pathways_gene_involved_to_consider
dim(inv_high_pathways_gene_involved_to_consider)
op <- par(oma=c(10,7,1,1))
Heatmap(inv_high_pathways_gene_involved_to_consider,cluster_rows = FALSE, cluster_columns = FALSE, col=col_fun, row_names_side = "left",
name="Activity", row_names_gp = gpar(fontsize = 8, col=colors[as.factor(rev_inv_high_pathways_df$clusters)]), column_names_gp = gpar(fontsize = 10),
column_title = "Median Activity of MRs in Enriched Pathways specific to INV High")
jpeg("../Results/Paper_Figures/Svgs_Jpgs/Supp_Figure_7.jpg",height = 800, width=1200, units="px",pointsize = 12, res = 0.75)
op <- par(oma=c(10,7,1,1))
Heatmap(inv_high_pathways_gene_involved_to_consider,cluster_rows = FALSE, cluster_columns = FALSE, col=col_fun, row_names_side = "left",
name="Activity", row_names_gp = gpar(fontsize = 8, col=colors[as.factor(rev_inv_high_pathways_df$clusters)]), column_names_gp = gpar(fontsize = 10),
column_title = "Median Activity of MRs in Enriched Pathways specific to INV High")
dev.off()
INV_High <- list()
INV_High$nodes <- data.frame(name = c(colnames(inv_high_pathways_gene_involved_to_consider),rownames(inv_high_pathways_gene_involved_to_consider)))
nodesgroup <- c(rep("white",length(colnames(inv_high_pathways_gene_involved_to_consider))),colors[rev_high_low_pathways_df$clusters])
INV_High$nodes$nodesgroup <- nodesgroup
edgelist <- NULL
for (i in 1:nrow(inv_high_pathways_gene_involved_to_consider))
{
for (j in 1:ncol(inv_high_pathways_gene_involved_to_consider))
{
pathway <- rownames(inv_high_pathways_gene_involved_to_consider)[i]
mr <- colnames(inv_high_pathways_gene_involved_to_consider)[j]
if (inv_high_pathways_gene_involved_to_consider[pathway,mr]>0)
{
mr_id <- which(INV_Highw$nodes$name==mr)-1
pathway_id <- which(INV_High$nodes$name==pathway)-1
temp <- cbind(mr_id,pathway_id,abs(inv_high_pathways_gene_involved_to_consider[pathway,mr]),INV_High$nodes[INV_High$nodes$name==pathway,"nodesgroup"])
edgelist <- rbind(edgelist,temp)
}
}
}
edgelist <- as.data.frame(edgelist)
colnames(edgelist) <- c("source","target","value","type")
edgelist$source <- as.numeric(as.vector(edgelist$source))
edgelist$target <- as.numeric(as.vector(edgelist$target))
edgelist$value <- as.numeric(as.vector(edgelist$value))
edgelist$type <- as.factor(as.vector(edgelist$type))
INV_High$links <- edgelist
# putting in a data.frame might help see problems
color_scale <- data.frame(
range = c(rep("white",length(colnames(inv_high_pathways_gene_involved_to_consider))),colors[rev_inv_high_pathways_df$clusters]),
domain = INV_High$nodes$name,
nodes = INV_High$nodes,
stringsAsFactors = FALSE
)
p_sankey <- sankeyNetwork(Links = INV_High$links, Nodes = INV_High$nodes, Source = "source",
Target = "target", Value = "value", LinkGroup = "type", NodeID = "name", NodeGroup = "nodesgroup",
units = "", fontSize = 14, nodeWidth = 25, iterations=0, fontFamily = "Arial",
colourScale = JS("d3.scaleOrdinal(d3.schemeCategory10);"))
#widget2png(p, "../Results/Paper_Figures/Svgs_Jpgs/Sankey_Plot_INV_Low_Figure_6A_1.png")
INV_High <- list()
INV_High$nodes <- data.frame(name = c(colnames(inv_high_pathways_gene_involved_to_consider),rownames(inv_high_pathways_gene_involved_to_consider)))
nodesgroup <- c(rep("white",length(colnames(inv_high_pathways_gene_involved_to_consider))),colors[rev_high_low_pathways_df$clusters])
INV_High$nodes$nodesgroup <- nodesgroup
INV_High <- list()
INV_High$nodes <- data.frame(name = c(colnames(inv_high_pathways_gene_involved_to_consider),rownames(inv_high_pathways_gene_involved_to_consider)))
nodesgroup <- c(rep("white",length(colnames(inv_high_pathways_gene_involved_to_consider))),colors[rev_high_low_pathways_df$clusters])
nodesgroup <- c(rep("white",length(colnames(inv_high_pathways_gene_involved_to_consider))),colors[rev_inv_high_low_pathways_df$clusters])
INV_High$nodes$nodesgroup <- nodesgroup
INV_High <- list()
INV_High$nodes <- data.frame(name = c(colnames(inv_high_pathways_gene_involved_to_consider),rownames(inv_high_pathways_gene_involved_to_consider)))
nodesgroup <- c(rep("white",length(colnames(inv_high_pathways_gene_involved_to_consider))),colors[rev_inv_high_pathways_df$clusters])
INV_High$nodes$nodesgroup <- nodesgroup
edgelist <- NULL
for (i in 1:nrow(inv_high_pathways_gene_involved_to_consider))
{
for (j in 1:ncol(inv_high_pathways_gene_involved_to_consider))
{
pathway <- rownames(inv_high_pathways_gene_involved_to_consider)[i]
mr <- colnames(inv_high_pathways_gene_involved_to_consider)[j]
if (inv_high_pathways_gene_involved_to_consider[pathway,mr]>0)
{
mr_id <- which(INV_Highw$nodes$name==mr)-1
pathway_id <- which(INV_High$nodes$name==pathway)-1
temp <- cbind(mr_id,pathway_id,abs(inv_high_pathways_gene_involved_to_consider[pathway,mr]),INV_High$nodes[INV_High$nodes$name==pathway,"nodesgroup"])
edgelist <- rbind(edgelist,temp)
}
}
}
edgelist <- as.data.frame(edgelist)
colnames(edgelist) <- c("source","target","value","type")
edgelist$source <- as.numeric(as.vector(edgelist$source))
edgelist$target <- as.numeric(as.vector(edgelist$target))
edgelist$value <- as.numeric(as.vector(edgelist$value))
edgelist$type <- as.factor(as.vector(edgelist$type))
INV_High$links <- edgelist
INV_High <- list()
INV_High$nodes <- data.frame(name = c(colnames(inv_high_pathways_gene_involved_to_consider),rownames(inv_high_pathways_gene_involved_to_consider)))
nodesgroup <- c(rep("white",length(colnames(inv_high_pathways_gene_involved_to_consider))),colors[rev_inv_high_pathways_df$clusters])
INV_High$nodes$nodesgroup <- nodesgroup
edgelist <- NULL
for (i in 1:nrow(inv_high_pathways_gene_involved_to_consider))
{
for (j in 1:ncol(inv_high_pathways_gene_involved_to_consider))
{
pathway <- rownames(inv_high_pathways_gene_involved_to_consider)[i]
mr <- colnames(inv_high_pathways_gene_involved_to_consider)[j]
if (inv_high_pathways_gene_involved_to_consider[pathway,mr]>0)
{
mr_id <- which(INV_High$nodes$name==mr)-1
pathway_id <- which(INV_High$nodes$name==pathway)-1
temp <- cbind(mr_id,pathway_id,abs(inv_high_pathways_gene_involved_to_consider[pathway,mr]),INV_High$nodes[INV_High$nodes$name==pathway,"nodesgroup"])
edgelist <- rbind(edgelist,temp)
}
}
}
edgelist <- as.data.frame(edgelist)
colnames(edgelist) <- c("source","target","value","type")
edgelist$source <- as.numeric(as.vector(edgelist$source))
edgelist$target <- as.numeric(as.vector(edgelist$target))
edgelist$value <- as.numeric(as.vector(edgelist$value))
edgelist$type <- as.factor(as.vector(edgelist$type))
INV_High$links <- edgelist
color_scale <- data.frame(
range = c(rep("white",length(colnames(inv_high_pathways_gene_involved_to_consider))),colors[rev_inv_high_pathways_df$clusters]),
domain = INV_High$nodes$name,
nodes = INV_High$nodes,
stringsAsFactors = FALSE
)
p_sankey <- sankeyNetwork(Links = INV_High$links, Nodes = INV_High$nodes, Source = "source",
Target = "target", Value = "value", LinkGroup = "type", NodeID = "name", NodeGroup = "nodesgroup",
units = "", fontSize = 14, nodeWidth = 25, iterations=0, fontFamily = "Arial",
colourScale = JS("d3.scaleOrdinal(d3.schemeCategory10);"))
p_sankey
p_sankey
